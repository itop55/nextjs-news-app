{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport { catchAxiosError } from \"./error\";\nimport { post } from \"./rest_service\";\nexport var COOKIES = {\n  authToken: \"myApp.authToken\"\n};\nexport function login(_x) {\n  return _login.apply(this, arguments);\n}\n\nfunction _login() {\n  _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(inputs) {\n    var data, res, token;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            data = new URLSearchParams(inputs);\n            _context.next = 3;\n            return post(\"/api/login\", data)[\"catch\"](catchAxiosError);\n\n          case 3:\n            res = _context.sent;\n\n            if (!res.error) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", res.error);\n\n          case 8:\n            if (!(!res.data || !res.data.token)) {\n              _context.next = 10;\n              break;\n            }\n\n            return _context.abrupt(\"return\", \"Something went wrong!\");\n\n          case 10:\n            token = res.data.token; // store the token into cookies\n\n            Cookie.set(COOKIES.authToken, token);\n            _context.next = 14;\n            return Router.push(\"/profile\");\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _login.apply(this, arguments);\n}","map":{"version":3,"sources":["C:/Users/CHOROK/projects/news-app/services/login_service.ts"],"names":["Cookie","Router","catchAxiosError","post","COOKIES","authToken","login","inputs","data","URLSearchParams","res","error","token","set","push"],"mappings":";;AACA,OAAOA,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,SAASC,eAAT,QAAgC,SAAhC;AACA,SAASC,IAAT,QAAqB,gBAArB;AAEA,OAAO,IAAMC,OAAO,GAAG;AACrBC,EAAAA,SAAS,EAAE;AADU,CAAhB;AAIP,gBAAsBC,KAAtB;AAAA;AAAA;;;oEAAO,iBAAqBC,MAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,YAAAA,IADD,GACQ,IAAIC,eAAJ,CAAoBF,MAApB,CADR;AAAA;AAAA,mBAEkBJ,IAAI,CAAC,YAAD,EAAeK,IAAf,CAAJ,UAA+BN,eAA/B,CAFlB;;AAAA;AAECQ,YAAAA,GAFD;;AAAA,iBAGDA,GAAG,CAACC,KAHH;AAAA;AAAA;AAAA;;AAAA,6CAIID,GAAG,CAACC,KAJR;;AAAA;AAAA,kBAKM,CAACD,GAAG,CAACF,IAAL,IAAa,CAACE,GAAG,CAACF,IAAJ,CAASI,KAL7B;AAAA;AAAA;AAAA;;AAAA,6CAMI,uBANJ;;AAAA;AAQGA,YAAAA,KARH,GAQaF,GAAG,CAACF,IARjB,CAQGI,KARH,EAUL;;AACAZ,YAAAA,MAAM,CAACa,GAAP,CAAWT,OAAO,CAACC,SAAnB,EAA8BO,KAA9B;AAXK;AAAA,mBAYCX,MAAM,CAACa,IAAP,CAAY,UAAZ,CAZD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import axios, { AxiosRequestConfig } from \"axios\";\nimport Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport { LoginInputs } from \"../pages/login\";\nimport { catchAxiosError } from \"./error\";\nimport { post } from \"./rest_service\";\n\nexport const COOKIES = {\n  authToken: \"myApp.authToken\"\n};\n\nexport async function login(inputs: LoginInputs): Promise<string | void> {\n  const data = new URLSearchParams(inputs);\n  const res: any = await post(\"/api/login\", data).catch(catchAxiosError);\n  if (res.error) {\n    return res.error;\n  } else if (!res.data || !res.data.token) {\n    return \"Something went wrong!\";\n  }\n  const { token } = res.data;\n\n  // store the token into cookies\n  Cookie.set(COOKIES.authToken, token);\n  await Router.push(\"/profile\");\n}\n"]},"metadata":{},"sourceType":"module"}