{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport { catchAxiosError } from \"./error\";\nimport { post } from \"./rest_service\";\nexport var COOKIES = {\n  authToken: \"myApp.authToken\"\n};\nexport function login(_x) {\n  return _login.apply(this, arguments);\n}\n\nfunction _login() {\n  _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(inputs) {\n    var data, res, token;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            data = new URLSearchParams(inputs);\n            _context.next = 3;\n            return post(\"/api/login\", data)[\"catch\"](catchAxiosError);\n\n          case 3:\n            res = _context.sent;\n            console.log(\"res\", res);\n\n            if (!res.error) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt(\"return\", res.error);\n\n          case 9:\n            if (!(!res.data || !res.data.token)) {\n              _context.next = 11;\n              break;\n            }\n\n            return _context.abrupt(\"return\", \"Something went wrong!\");\n\n          case 11:\n            token = res.data.token; // store the token into cookies\n\n            Cookie.set(COOKIES.authToken, token);\n            _context.next = 15;\n            return Router.push(\"/profile\");\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _login.apply(this, arguments);\n}","map":{"version":3,"sources":["C:/Users/CHOROK/projects/news-app/services/login_service.ts"],"names":["Cookie","Router","catchAxiosError","post","COOKIES","authToken","login","inputs","data","URLSearchParams","res","console","log","error","token","set","push"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,SAASC,eAAT,QAAgC,SAAhC;AACA,SAASC,IAAT,QAAqB,gBAArB;AAEA,OAAO,IAAMC,OAAO,GAAG;AACrBC,EAAAA,SAAS,EAAE;AADU,CAAhB;AAIP,gBAAsBC,KAAtB;AAAA;AAAA;;;oEAAO,iBAAqBC,MAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,YAAAA,IADD,GACQ,IAAIC,eAAJ,CAAoBF,MAApB,CADR;AAAA;AAAA,mBAEkBJ,IAAI,CAAC,YAAD,EAAeK,IAAf,CAAJ,UAA+BN,eAA/B,CAFlB;;AAAA;AAECQ,YAAAA,GAFD;AAGLC,YAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBF,GAAnB;;AAHK,iBAIDA,GAAG,CAACG,KAJH;AAAA;AAAA;AAAA;;AAAA,6CAKIH,GAAG,CAACG,KALR;;AAAA;AAAA,kBAMM,CAACH,GAAG,CAACF,IAAL,IAAa,CAACE,GAAG,CAACF,IAAJ,CAASM,KAN7B;AAAA;AAAA;AAAA;;AAAA,6CAOI,uBAPJ;;AAAA;AASGA,YAAAA,KATH,GASaJ,GAAG,CAACF,IATjB,CASGM,KATH,EAWL;;AACAd,YAAAA,MAAM,CAACe,GAAP,CAAWX,OAAO,CAACC,SAAnB,EAA8BS,KAA9B;AAZK;AAAA,mBAaCb,MAAM,CAACe,IAAP,CAAY,UAAZ,CAbD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport { LoginInputs } from \"../pages/login\";\nimport { catchAxiosError } from \"./error\";\nimport { post } from \"./rest_service\";\n\nexport const COOKIES = {\n  authToken: \"myApp.authToken\"\n};\n\nexport async function login(inputs: LoginInputs): Promise<string | void> {\n  const data = new URLSearchParams(inputs);\n  const res: any = await post(\"/api/login\", data).catch(catchAxiosError);\n  console.log(\"res\", res)\n  if (res.error) {\n    return res.error;\n  } else if (!res.data || !res.data.token) {\n    return \"Something went wrong!\";\n  }\n  const { token } = res.data;\n\n  // store the token into cookies\n  Cookie.set(COOKIES.authToken, token);\n  await Router.push(\"/profile\");\n}\n"]},"metadata":{},"sourceType":"module"}