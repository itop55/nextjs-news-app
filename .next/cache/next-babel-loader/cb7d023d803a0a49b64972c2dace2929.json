{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"C:\\\\Users\\\\CHOROK\\\\projects\\\\news-app\\\\pages\\\\profile.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { privateRoute } from \"../components/private_route\";\nimport Cookie from \"js-cookie\";\nimport Router from \"next/router\";\nimport { COOKIES } from \"../services/login_service\";\nimport { get } from \"../services/rest_service\";\nimport Layout from \"../components/layout\";\n\nfunction Page(props) {\n  var logout = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Cookie.remove(COOKIES.authToken);\n              _context.next = 3;\n              return Router.push(\"/login\");\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function logout() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var _props$auth$userData = props.auth.userData,\n      email = _props$auth$userData.email,\n      name = _props$auth$userData.name,\n      avatarUrl = _props$auth$userData.avatarUrl,\n      role = _props$auth$userData.role;\n  return __jsx(Layout, {\n    title: \"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }\n  }, __jsx(\"section\", {\n    className: \"user-profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"user-profile__title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 11\n    }\n  }, __jsx(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 13\n    }\n  }, \"Profile info\"), __jsx(\"button\", {\n    className: \"btn-secondary\",\n    onClick: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 13\n    }\n  }, \"Logout\")), __jsx(\"div\", {\n    className: \"user-profile__vn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"user-profile__avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 13\n    }\n  }, __jsx(\"img\", {\n    src: avatarUrl,\n    alt: \"user avatar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 15\n    }\n  }), __jsx(\"div\", {\n    className: \"user-profile__avatar-desc\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 15\n    }\n  }, __jsx(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 17\n    }\n  }, role), __jsx(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 17\n    }\n  }, name))), __jsx(\"div\", {\n    className: \"user-profile__desc\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 13\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 15\n    }\n  }, email)))));\n}\n\n_c = Page;\n\nPage.getInitialProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2) {\n    var auth, res, message;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            auth = _ref2.auth;\n            _context2.next = 3;\n            return get(\"/api/restricted\", {\n              headers: {\n                Authorization: auth.authorizationString\n              }\n            });\n\n          case 3:\n            res = _context2.sent;\n            message = \"Something unexpected happened!\";\n\n            if (res.error) {\n              message = res.error;\n            } else if (res.data && res.data.message) {\n              message = res.data.message;\n            }\n\n            return _context2.abrupt(\"return\", {\n              message: message,\n              auth: auth\n            });\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nexport default _c2 = privateRoute(Page);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Page\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Users/CHOROK/projects/news-app/pages/profile.tsx"],"names":["privateRoute","Cookie","Router","COOKIES","get","Layout","Page","props","logout","remove","authToken","push","auth","userData","email","name","avatarUrl","role","getInitialProps","headers","Authorization","authorizationString","res","message","error","data"],"mappings":"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","sourcesContent":["import { AuthProps, privateRoute } from \"../components/private_route\"\nimport Cookie from \"js-cookie\"\nimport Router from \"next/router\"\nimport { COOKIES } from \"../services/login_service\"\nimport { get } from \"../services/rest_service\"\nimport Layout from \"../components/layout\"\n\ntype Props = AuthProps & {\n  message: string\n}\n\nfunction Page(props: Props) {\n  const logout = async () => {\n    Cookie.remove(COOKIES.authToken);\n    await Router.push(\"/login\");\n  };\n  const {email, name, avatarUrl, role} = props.auth.userData\n\n  return (\n      <Layout title=\"Профиль пользователя\">\n        <section className=\"user-profile\">\n          <div className=\"user-profile__title\">\n            <h1>Profile info</h1>\n            <button className=\"btn-secondary\" onClick={logout}>Logout</button>\n          </div>\n          <div className=\"user-profile__vn\">\n            <div className=\"user-profile__avatar\">\n              <img src={avatarUrl} alt=\"user avatar\"/>\n              <div className=\"user-profile__avatar-desc\">\n                <h6>{role}</h6>\n                <h3>{name}</h3>\n              </div>\n            </div>\n            <div className=\"user-profile__desc\">\n              <p>{email}</p>\n            </div>\n          </div>\n        </section>\n      </Layout>\n  )\n}\n\nPage.getInitialProps = async ({ auth }: AuthProps): Promise<Props> => {\n  const res: any = await get(\"/api/restricted\", {\n    headers: {\n      Authorization: auth.authorizationString\n    }\n  });\n\n  let message = \"Something unexpected happened!\";\n\n  if (res.error) {\n    message = res.error;\n  } else if (res.data && res.data.message) {\n    message = res.data.message\n  }\n\n  return { message, auth, };\n};\n\nexport default privateRoute(Page);\n"]},"metadata":{},"sourceType":"module"}